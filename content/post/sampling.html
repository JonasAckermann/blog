---
title: "Sampling from a distribution with a known CDF"
author: "Jonny Law"
draft: TRUE
date: '2019-02-25'
slug: inverse-sampling
categories:
  - R
  - Running
tags: []
---



<p>A distribution with an inverse cumulative distribution function (CDF) can be sampled from using just samples from <span class="math inline">\(U[0, 1]\)</span>. The inverse CDF (sometimes called the quantile function) is the value of <span class="math inline">\(x\)</span> such that <span class="math inline">\(F_X(x) = Pr(X \leq x) = p\)</span>. Consider a that a transformation <span class="math inline">\(g: [0, 1] \rightarrow \mathbb{R}\)</span>, exists which takes a value sampled from the standard uniform distribution <span class="math inline">\(u \sim U[0, 1]\)</span> and returns a value distributed according to the target distribution. Then the inverse CDF can be written as:</p>
<span class="math display">\[\begin{equation*}
Pr(g(U) \leq x) = Pr(U \leq g^{-1}(x)) = g^{-1}(x)
\end{equation*}\]</span>
<p>% Since the CDF of the uniform distribution over the interval <span class="math inline">\([0, 1]\)</span> is:</p>
<span class="math display">\[\begin{align*}
  F_U(u) =
  \begin{cases}
    0 &amp; u &lt; 0 \\
    u &amp; u \in [0, 1) \\
    1 &amp; u \geq 1
  \end{cases}
\end{align*}\]</span>
<p>% Then <span class="math inline">\(F_x^{-1}(X) = g(x)\)</span> as required. Algorithm~ summarises the inverse sampling procedure.</p>
<ol style="list-style-type: decimal">
<li>Sample <span class="math inline">\(u \sim U[0, 1]\)</span>;</li>
<li>Evaluate <span class="math inline">\(x = F^{-1}(u)\)</span>;</li>
<li>Return <span class="math inline">\(x\)</span>;</li>
</ol>
<p>Most statistical packages will expose the quantile function for common distributions making it practical to use inverse sampling. The figure below shows a histogram of 1,000 simulated values from a <span class="math inline">\(\textrm{Gamma}(3, 4)\)</span> distribution using the inverse CDF method, the analytical density is plotted in red.</p>
<pre class="r"><code>inverse_cdf_sample &lt;- function(inv_cdf) {
  u &lt;- runif(1)
  inv_cdf(u)
}

inv_cdf &lt;- function(x) qgamma(p = x, shape = 3, rate = 4)
gamma_samples &lt;- replicate(1000, inverse_cdf_sample(inv_cdf))

qplot(gamma_samples, geom = &quot;blank&quot;) +
  stat_function(
    fun = function(x) dgamma(x, shape = 3, rate = 4),
    aes(colour = &quot;Gamma Density&quot;)
  ) +
  geom_histogram(aes(y = ..density..), alpha = 0.4) +
  theme(
    text = element_text(size = 20), legend.title = element_blank(),
    legend.text = element_text(size = rel(1.3)), legend.position = c(0.8, 0.8)
  )</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-1"></span>
<img src="/post/sampling_files/figure-html/unnamed-chunk-1-1.png" alt="Samples from $ extrm{Gamma}(3, 4)$ using the inverse CDF method plotted with the analytical PDF" width="672" />
<p class="caption">
Figure 1: Samples from $ extrm{Gamma}(3, 4)$ using the inverse CDF method plotted with the analytical PDF
</p>
</div>
